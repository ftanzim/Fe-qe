# How to compute bands projection in QE
1) to run an `scf` calculation for your system
2) create a new `bands` folder and copy the `prefix.save` from the `scf` here
3) create a bands calculation file in QE by specifying `calculation='bands'`
**NB** Remember when you run a calculation to change the name of the log/output file so that it does not get ovewritten. You can use
`prefix.out`,`prefix_bands.out`,`projwfc.log` (last one is .log because it's the only postfix accepted by Yambopy)
Here is an example for mos2ws2 
<pre>
&control
         calculation = 'bands'
       etot_conv_thr = 1e-09
       forc_conv_thr = 1e-06
         max_seconds = 82800
              prefix = 'mos2ws2'
          pseudo_dir = '/home/rireho/pseudos/SO_stringent'
        restart_mode = 'from_scratch'
             tprnfor = .true.
             tstress = .true.
           verbosity = 'high'
          wf_collect = .true.
/&end
&system
     assume_isolated = '2D'
           celldm(1) = 6.029366218639496
           celldm(3) = 9.095094661279013
             ecutwfc = 150
    force_symmorphic = .true.
               ibrav = 4
            lspinorb = .true.
                 nat = 6
                nbnd = 62
            noncolin = .true.
                ntyp = 3
         occupations = 'fixed'
            vdw_corr = 'grimme-d2'
/&end
&electrons
            conv_thr = 1e-12
      diago_full_acc = .true.
        diagonalization ='cg'
    electron_maxstep = 1000
/&end


ATOMIC_SPECIES
   W   183.84                W.upf
   S   32.065                S.upf
  Mo    95.95               Mo.upf
ATOMIC_POSITIONS { angstrom }
  S   1.5953035466   0.9210470899   2.9829195956
 Mo  -0.0000015946   1.8420969436   4.5418655815
  S   1.5953035466   0.9210470899   6.0993044458
  S  -0.0000015946   1.8420969436   9.1391484802
  W   1.5953035466   0.9210470899  10.7030242951
  S  -0.0000015946   1.8420969436  12.2700919465
K_POINTS { crystal }
91
  0.00000000   0.00000000   0.00000000   1.00000000
  0.01666667   0.00000000   0.00000000   1.00000000
  0.03333333   0.00000000   0.00000000   1.00000000
  0.05000000   0.00000000   0.00000000   1.00000000
  0.06666667   0.00000000   0.00000000   1.00000000
  0.08333333   0.00000000   0.00000000   1.00000000
  0.10000000   0.00000000   0.00000000   1.00000000
  0.11666667   0.00000000   0.00000000   1.00000000
  0.13333333   0.00000000   0.00000000   1.00000000
  0.15000000   0.00000000   0.00000000   1.00000000
  0.16666667   0.00000000   0.00000000   1.00000000
  0.18333333   0.00000000   0.00000000   1.00000000
  0.20000000   0.00000000   0.00000000   1.00000000
  0.21666667   0.00000000   0.00000000   1.00000000
  0.23333333   0.00000000   0.00000000   1.00000000
  0.25000000   0.00000000   0.00000000   1.00000000
  0.26666667   0.00000000   0.00000000   1.00000000
  0.28333333   0.00000000   0.00000000   1.00000000
  0.30000000   0.00000000   0.00000000   1.00000000
  0.31666667   0.00000000   0.00000000   1.00000000
  0.33333333   0.00000000   0.00000000   1.00000000
  0.35000000   0.00000000   0.00000000   1.00000000
  0.36666667   0.00000000   0.00000000   1.00000000
  0.38333333   0.00000000   0.00000000   1.00000000
  0.40000000   0.00000000   0.00000000   1.00000000
  0.41666667   0.00000000   0.00000000   1.00000000
  0.43333333   0.00000000   0.00000000   1.00000000
  0.45000000   0.00000000   0.00000000   1.00000000
  0.46666667   0.00000000   0.00000000   1.00000000
  0.48333333   0.00000000   0.00000000   1.00000000
  0.50000000   0.00000000   0.00000000   1.00000000
  0.49444444   0.01111111   0.00000000   1.00000000
  0.48888889   0.02222222   0.00000000   1.00000000
  0.48333333   0.03333333   0.00000000   1.00000000
  0.47777778   0.04444444   0.00000000   1.00000000
  0.47222222   0.05555556   0.00000000   1.00000000
  0.46666667   0.06666667   0.00000000   1.00000000
  0.46111111   0.07777778   0.00000000   1.00000000
  0.45555556   0.08888889   0.00000000   1.00000000
  0.45000000   0.10000000   0.00000000   1.00000000
  0.44444444   0.11111111   0.00000000   1.00000000
  0.43888889   0.12222222   0.00000000   1.00000000
  0.43333333   0.13333333   0.00000000   1.00000000
  0.42777778   0.14444444   0.00000000   1.00000000
  0.42222222   0.15555556   0.00000000   1.00000000
  0.41666667   0.16666667   0.00000000   1.00000000
  0.41111111   0.17777778   0.00000000   1.00000000
  0.40555556   0.18888889   0.00000000   1.00000000
  0.40000000   0.20000000   0.00000000   1.00000000
  0.39444444   0.21111111   0.00000000   1.00000000
  0.38888889   0.22222222   0.00000000   1.00000000
  0.38333333   0.23333333   0.00000000   1.00000000
  0.37777778   0.24444444   0.00000000   1.00000000
  0.37222222   0.25555556   0.00000000   1.00000000
  0.36666667   0.26666667   0.00000000   1.00000000
  0.36111111   0.27777778   0.00000000   1.00000000
  0.35555556   0.28888889   0.00000000   1.00000000
  0.35000000   0.30000000   0.00000000   1.00000000
  0.34444444   0.31111111   0.00000000   1.00000000
  0.33888889   0.32222222   0.00000000   1.00000000
  0.33333333   0.33333333   0.00000000   1.00000000
  0.32222222   0.32222222   0.00000000   1.00000000
  0.31111111   0.31111111   0.00000000   1.00000000
  0.30000000   0.30000000   0.00000000   1.00000000
  0.28888889   0.28888889   0.00000000   1.00000000
  0.27777778   0.27777778   0.00000000   1.00000000
  0.26666667   0.26666667   0.00000000   1.00000000
  0.25555556   0.25555556   0.00000000   1.00000000
  0.24444444   0.24444444   0.00000000   1.00000000
  0.23333333   0.23333333   0.00000000   1.00000000
  0.22222222   0.22222222   0.00000000   1.00000000
  0.21111111   0.21111111   0.00000000   1.00000000
  0.20000000   0.20000000   0.00000000   1.00000000
  0.18888889   0.18888889   0.00000000   1.00000000
  0.17777778   0.17777778   0.00000000   1.00000000
  0.16666667   0.16666667   0.00000000   1.00000000
  0.15555556   0.15555556   0.00000000   1.00000000
  0.14444444   0.14444444   0.00000000   1.00000000
  0.13333333   0.13333333   0.00000000   1.00000000
  0.12222222   0.12222222   0.00000000   1.00000000
  0.11111111   0.11111111   0.00000000   1.00000000
  0.10000000   0.10000000   0.00000000   1.00000000
  0.08888889   0.08888889   0.00000000   1.00000000
  0.07777778   0.07777778   0.00000000   1.00000000
  0.06666667   0.06666667   0.00000000   1.00000000
  0.05555556   0.05555556   0.00000000   1.00000000
  0.04444444   0.04444444   0.00000000   1.00000000
  0.03333333   0.03333333   0.00000000   1.00000000
  0.02222222   0.02222222   0.00000000   1.00000000
  0.01111111   0.01111111   0.00000000   1.00000000
  0.00000000   0.00000000   0.00000000   1.00000000
</pre>
Please note that the number of bands is the number of electrons (occupied states) plus the bands in the conduction manifold that you want, Moreover have to specify the `K_POINTS` list point by point (you might want to do only $\Gamma$)
4) Now you need to run a `bands.x` calculation with the bands.x executable (not `pw.x`) This is an example
<pre>
&BANDS
    prefix = 'mos2ws2',
    outdir = './',
    lsym = .true.,
    filband = 'mos2ws2-AA-bands.dat'
 /
 </pre>
 5) You can also run the `projbands.x` executable to get the projected band structure within the `bands` folder
<pre>
&projwfc
    prefix = 'mos2ws2',
    outdir = './',
    ngauss=0, degauss=0.036748
    DeltaE=0.01
    kresolveddos=.true.
    filpdos = 'mos2ws2-pdos.dat'
 /
</pre>
**NB** Please check all the flags from the documentation that might be specific to your system and not to mos2ws2
# Output files
The calculation in step 2) is basically an nscf calculation
In step 3) you get the bands symmetries
In step 4) you get info on projection of the wavefunctions

# How to use YamboPy for post-processing
To be written, for now refer to the online [documentation](https://www.yambo-code.eu/wiki/index.php/Yambopy_tutorial:_band_structures)